package org.suntao.easyorm.executor.defaults;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import org.suntao.easyorm.executor.Exceutor;
import org.suntao.easyorm.map.Mapping;
import org.suntao.easyorm.map.ResultMap;
import org.suntao.easyorm.session.SqlSession;

/**
 * 简化sql解释器
 * 
 * @author suntao
 *
 */
public class SimpleExecutor implements Exceutor {
	private Connection conn;
	private Mapping mapping;

	public SimpleExecutor(Connection conn, Mapping mapping) {
		super();
		this.conn = conn;
		this.mapping = mapping;
	}

	@SuppressWarnings("unchecked")
	@Override
	public <T> List<T> selectList(ResultMap resultMap, String sqlStr) {
		List result = null;
		Statement statement = null;
		ResultSet resultSet = null;
		try {
			statement = conn.createStatement();
			resultSet = statement.executeQuery(sqlStr);
			result = new ArrayList<T>();
			while (resultSet.next()) {
				result.add(mapping.getModel(resultMap, resultSet));
			}
			if (resultSet != null)
				resultSet.close();
			if (statement != null)
				statement.close();
		} catch (SQLException e) {
			e.printStackTrace();
		}

		return result;
	}

	@Override
	public <T> List<T> selectOne(ResultMap resultMap, String sqlStr) {
		return null;
	}

	@Override
	public Integer update(String sqlStr) {
		return null;
	}

	@Override
	public Integer delete(String sqlStr) {
		return null;
	}

	@Override
	public Integer insert(String sqlStr) {
		return null;
	}

}
